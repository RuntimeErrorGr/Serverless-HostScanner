Scan UUID,Scan Name,Target,Finding Name,Port,Service,Protocol,Port State,Severity,Description,Evidence,Recommendation,Created At
{% for finding in all_findings -%}
"{{ scan.uuid }}","{{ scan.name | replace('"', '""') }}","{{ finding.target.name | replace('"', '""') if finding.target else '' }}","{{ finding.name | replace('"', '""') if finding.name else '' }}","{{ finding.port if finding.port else '' }}","{{ finding.service | replace('"', '""') if finding.service else '' }}","{{ finding.protocol | replace('"', '""') if finding.protocol else '' }}","{{ finding.port_state.value if finding.port_state else '' }}","{{ finding.severity.value if finding.severity else '' }}","{{ finding.description | replace('"', '""') | replace('\n', ' ') if finding.description else '' }}","{{ finding.evidence | replace('"', '""') | replace('\n', ' ') if finding.evidence else '' }}","{{ finding.recommendation | replace('"', '""') | replace('\n', ' ') if finding.recommendation else '' }}","{{ finding.created_at.isoformat() if finding.created_at else '' }}"
{% endfor %} 